<% if flash[:notice].present? || flash[:error].present? %>
  <div class="row">
    <div class="col-md-12">
      <% if flash[:notice].present? %>
        <div class="alert alert-info alert-dismissable">
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
          <h3 style="border: 0;"><%= flash.notice %></h3>
        </div>
      <% end %>
      <% if flash[:error].present? %>
        <div class="alert alert-danger alert-dismissable">
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
          <h3 style="border: 0;"><%= flash[:error] %></h3>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<div class="row">
  <div class="<%= current_user.admin? ? "col-sm-7" : "col-sm-12" %>">
    <div class="panel panel-default">
      <div class="panel-body">
        <h3>Camps and Events</h3>

        <% @locations.each do |location| %>
          <div class="row">
            <div class='col-md-12' style="margin-top: 15px;">
              <h4>
                <%= location.human_location %>
                <% if current_user.admin %>
                  <small style="float: right; cursor: pointer; position: absolute; bottom: 20px; right: 20px;">
                    <%= link_to "edit", "#_", class: "edit-location", 
                                              data: {hosting_location: location.hosting_location, site_id: location.site_id} %>
                  </small>
                <% end %>
              </h4>
            </div>
          </div>

          <% location.events.each do |event| %>
            <div class="row event">
              <div class='col-md-12'>
                <%= link_to event do 
                      "#{event.title} - #{abbr_event_days(event)} ".html_safe +
                      event_icons(event).html_safe
                    end
                %>
              </div>
            </div>
          <% end %>
        <% end %>

      </div>
    </div>
  </div>

  <% if current_user.admin %>
    <div class="col-sm-5">
      <div class="panel panel-default">
        <div class="panel-body">
          <h4>Update a Location</h4>
          <p class="opening-message">
            Click a location on the left to edit.
          </p>

          <%= form_for :location, method: :put, html: {id: "edit-location", style: "display: none;"} do |f| %>
            <div class="form-group">
              <%= f.label :hosting_location, "Camp Name" %></br>
              <%= f.text_field :hosting_location, class: "form-control" %>
            </div>

            <div class="form-group">
              <%= f.label :site_id, "Site ID" %></br>
              <%= f.text_field :site_id, class: "form-control" %>
            </div>

            <%= f.hidden_field :original_site_id %>
            <%= f.hidden_field :original_hosting_location %>

            <div class="form-group">
              <%= f.submit "Update Location", class: "btn btn-default" %>
            </div>
          <% end %>

        </div>
      </div>
    </div>
  <% end %>

</div> <!-- /row -->

